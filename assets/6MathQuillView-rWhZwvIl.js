import{Z as te,f as le,T as ae,E as ne}from"./style-B3B0FLO6.js";import{d as oe,s as se,g as d,q as ie,h as ue,a as _,b as t,i as a,j as n,k as c,l as B,E as p,f as r,F as g,r as V,t as E,o as h,p as re}from"./index-CNbfcNDr.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";const me={class:"mathquill-container"},ce={class:"header"},pe={class:"actions"},fe={class:"editor-wrapper"},ve={class:"mathquill-dialog"},xe={class:"editor-section"},_e={class:"template-section"},he={class:"template-section"},we={class:"template-section"},ye={class:"template-section"},Ce={class:"output-section"},be={class:"render-preview"},Me={class:"preview"},Qe=["innerHTML"],ke=oe({__name:"6MathQuillView",setup(ge){te.registerModule(le);const w=se(),f=d("<p>欢迎使用富文本编辑器！点击上方按钮插入 MathQuill 公式。</p>"),y=d(""),q=d("default"),v=d(null),C=d(),b=d();let i=null,M=null;const x=d(!1),u=d(""),F=d("common"),I=[{latex:"\\frac{\\dot{V}_A}{\\dot{Q}}",name:"通气血流比"},{latex:"\\dot{V}_A = 4.2\\text{ L/min}",name:"肺泡通气量"},{latex:"\\dot{Q} = 5.0\\text{ L/min}",name:"肺血流量"},{latex:"\\frac{\\dot{V}_A}{\\dot{Q}} \\approx 0.8",name:"正常V̇A/Q̇比值"},{latex:"\\frac{\\dot{V}_A}{\\dot{Q}} = 0",name:"分流状态"},{latex:"\\frac{\\dot{V}_A}{\\dot{Q}} = \\infty",name:"死腔状态"},{latex:"Q_s = 5.0\\text{ L/min}",name:"心输出量"},{latex:"P_{O_2} = 40\\text{ mmHg}",name:"静脉血氧分压"},{latex:"P_{CO_2}",name:"二氧化碳分压"}],j=[{latex:"\\text{BMI} = \\frac{\\text{体重}}{\\text{身高}^2}",name:"BMI指数"},{latex:"\\text{MAP} = \\text{DBP} + \\frac{1}{3}(\\text{SBP} - \\text{DBP})",name:"平均动脉压"},{latex:"\\text{CO} = \\text{HR} \\times \\text{SV}",name:"心输出量"}],P=[{latex:"E = mc^2",name:"质能方程"},{latex:"F = ma",name:"牛顿第二定律"},{latex:"a^2 + b^2 = c^2",name:"勾股定理"}],A=[{latex:"\\frac{a}{b}",name:"分数"},{latex:"\\sqrt{x}",name:"平方根"},{latex:"x^{n}",name:"幂"},{latex:"\\int_{a}^{b} f(x) dx",name:"定积分"},{latex:"\\sum_{i=1}^{n} x_i",name:"求和"}],S={excludeKeys:[]},H={placeholder:"请输入内容...",MENU_CONF:{}},N=()=>new Promise(o=>{if(window.MathQuill){v.value=window.MathQuill.getInterface(2),o(!0);return}const e=document.createElement("script");e.src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js",e.onload=()=>{const s=document.createElement("link");s.rel="stylesheet",s.href="https://cdn.bootcdn.net/ajax/libs/mathquill/0.10.1/mathquill.min.css",document.head.appendChild(s);const m=document.createElement("script");m.src="https://cdn.bootcdn.net/ajax/libs/mathquill/0.10.1/mathquill.min.js",m.onload=()=>{v.value=window.MathQuill.getInterface(2),p.success("MathQuill 加载成功"),o(!0)},document.body.appendChild(m)},document.body.appendChild(e)}),R=()=>{!C.value||!v.value||(C.value.innerHTML="",i=v.value.MathField(C.value,{spaceBehavesLikeTab:!0,handlers:{edit:()=>{i&&(u.value=i.latex(),Q())}}}),i.latex("f(x) = \\frac{1}{\\sqrt{2\\pi}} e^{-\\frac{x^2}{2}}"),u.value=i.latex(),Q())},U=()=>{!b.value||!v.value||(b.value.innerHTML="",M=v.value.StaticMath(b.value))},Q=()=>{M&&u.value&&M.latex(u.value)},z=()=>{i&&i.latex(u.value),Q()},k=o=>{i&&(i.latex(o),u.value=o,i.focus(),Q())},D=()=>{x.value=!0,re(()=>{i||(R(),U())})},O=()=>{if(!u.value.trim()){p.warning("请输入公式");return}const o=w.value;if(o)try{const e=o,s={type:"formula",value:u.value,children:[{text:""}]};e.insertNode(s),x.value=!1,p.success("公式已插入")}catch(e){console.error("插入公式失败:",e),p.error("插入失败，请重试")}},$=o=>{w.value=o,p.success("编辑器加载完成")},X=()=>{y.value=f.value,p.success("内容已更新到预览区域"),console.log("编辑器内容：",f.value)},Z=()=>{const o=`
    <h2>这是一个示例标题</h2>
    <p>这是一段示例文本，展示了富文本编辑器的基本功能。</p>
    <p>数学公式示例：<span data-w-e-type="formula" data-w-e-is-void data-w-e-is-inline data-value="E=mc^2"></span></p>
    <p>通气血流比：<span data-w-e-type="formula" data-w-e-is-void data-w-e-is-inline data-value="\\frac{\\dot{V}_A}{\\dot{Q}} \\approx 0.8"></span></p>
  `;f.value=o,y.value=o,p.success("已设置示例内容")},K=()=>{f.value="",y.value="",p.info("内容已清空")};return ie(async()=>{await N()}),ue(()=>{const o=w.value;o!=null&&(o.destroy(),i=null,M=null)}),(o,e)=>{const s=c("el-button"),m=c("el-tab-pane"),W=c("el-tabs"),L=c("el-col"),G=c("el-input"),J=c("el-row"),Y=c("el-dialog"),ee=c("el-card");return h(),_("div",me,[t("div",ce,[e[9]||(e[9]=t("h2",null,"富文本编辑器 (WangEditor + MathQuill)",-1)),e[10]||(e[10]=t("p",{class:"subtitle"},"集成 MathQuill 的交互式数学公式编辑能力",-1)),t("div",pe,[a(s,{type:"primary",onClick:X},{default:n(()=>[...e[5]||(e[5]=[r("获取内容",-1)])]),_:1}),a(s,{onClick:Z},{default:n(()=>[...e[6]||(e[6]=[r("设置示例",-1)])]),_:1}),a(s,{onClick:K},{default:n(()=>[...e[7]||(e[7]=[r("清空",-1)])]),_:1}),a(s,{type:"success",onClick:D},{default:n(()=>[...e[8]||(e[8]=[t("span",{style:{"font-size":"16px","font-weight":"bold"}},"∑",-1),r(" 插入公式 ",-1)])]),_:1})])]),t("div",fe,[a(B(ae),{style:{"border-bottom":"1px solid #ccc"},editor:w.value,defaultConfig:S,mode:q.value},null,8,["editor","mode"]),a(B(ne),{style:{height:"300px","overflow-y":"hidden"},modelValue:f.value,"onUpdate:modelValue":e[0]||(e[0]=l=>f.value=l),defaultConfig:H,mode:q.value,onOnCreated:$},null,8,["modelValue","mode"])]),a(Y,{modelValue:x.value,"onUpdate:modelValue":e[4]||(e[4]=l=>x.value=l),title:"插入数学公式 (MathQuill)",width:"1000px","close-on-click-modal":!1},{footer:n(()=>[a(s,{onClick:e[3]||(e[3]=l=>x.value=!1)},{default:n(()=>[...e[15]||(e[15]=[r("取消",-1)])]),_:1}),a(s,{type:"primary",onClick:O},{default:n(()=>[...e[16]||(e[16]=[r("确定插入",-1)])]),_:1})]),default:n(()=>[t("div",ve,[a(J,{gutter:20},{default:n(()=>[a(L,{span:14},{default:n(()=>[t("div",xe,[e[11]||(e[11]=t("h4",null,"公式编辑器：",-1)),t("div",{ref_key:"mathQuillEditorRef",ref:C,class:"mathquill-wrapper"},null,512),e[12]||(e[12]=t("div",{class:"editor-tips"},[t("p",null,[t("strong",null,"提示：")]),t("ul",null,[t("li",null,"点击编辑器开始输入数学公式"),t("li",null,"使用 Tab 键在占位符间切换"),t("li",null,"支持键盘输入 LaTeX 语法")])],-1))]),a(W,{modelValue:F.value,"onUpdate:modelValue":e[1]||(e[1]=l=>F.value=l),type:"card",class:"template-tabs"},{default:n(()=>[a(m,{label:"常用",name:"common"},{default:n(()=>[t("div",_e,[(h(),_(g,null,V(P,l=>a(s,{key:l.latex,size:"small",onClick:T=>k(l.latex)},{default:n(()=>[r(E(l.name),1)]),_:2},1032,["onClick"])),64))])]),_:1}),a(m,{label:"呼吸生理学",name:"respiratory"},{default:n(()=>[t("div",he,[(h(),_(g,null,V(I,l=>a(s,{key:l.latex,size:"small",onClick:T=>k(l.latex)},{default:n(()=>[r(E(l.name),1)]),_:2},1032,["onClick"])),64))])]),_:1}),a(m,{label:"医学",name:"medical"},{default:n(()=>[t("div",we,[(h(),_(g,null,V(j,l=>a(s,{key:l.latex,size:"small",onClick:T=>k(l.latex)},{default:n(()=>[r(E(l.name),1)]),_:2},1032,["onClick"])),64))])]),_:1}),a(m,{label:"数学",name:"math"},{default:n(()=>[t("div",ye,[(h(),_(g,null,V(A,l=>a(s,{key:l.latex,size:"small",onClick:T=>k(l.latex)},{default:n(()=>[r(E(l.name),1)]),_:2},1032,["onClick"])),64))])]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(L,{span:10},{default:n(()=>[t("div",Ce,[e[13]||(e[13]=t("h4",null,"LaTeX 代码：",-1)),a(G,{modelValue:u.value,"onUpdate:modelValue":e[2]||(e[2]=l=>u.value=l),type:"textarea",rows:4,onInput:z},null,8,["modelValue"]),e[14]||(e[14]=t("h4",{style:{"margin-top":"16px"}},"渲染预览：",-1)),t("div",be,[t("div",{ref_key:"previewRef",ref:b,class:"preview-math"},null,512)])])]),_:1})]),_:1})])]),_:1},8,["modelValue"]),t("div",Me,[e[17]||(e[17]=t("h3",null,"内容预览：",-1)),a(ee,null,{default:n(()=>[t("div",{innerHTML:y.value},null,8,Qe)]),_:1})])])}}}),qe=de(ke,[["__scopeId","data-v-00b447fe"]]);export{qe as default};
