import{Z as oe,f as se,T as ie,E as re}from"./style-G2qrDrkG.js";import{k as ue}from"./katex.min-0MFFjn28.js";import{d as de,r,s as ce,i as me,j as pe,a as f,b as t,k as a,l as o,m,p as I,h as p,f as c,F as V,g as E,t as T,o as v,x as j}from"./index-CMOhjVMu.js";import{_ as fe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ve={class:"mathquill-container"},xe={key:0,class:"loading-container"},_e={key:1,class:"main-content"},he={class:"header"},ye={class:"actions"},we={class:"editor-wrapper"},Ce={class:"mathquill-dialog"},be={class:"editor-section"},ke={class:"template-section"},ge={class:"template-section"},Me={class:"template-section"},Qe={class:"template-section"},Ve={class:"output-section"},Ee={class:"render-preview"},Te={class:"preview"},Fe=["innerHTML"],Le=de({__name:"6MathQuillView",setup(qe){oe.registerModule(se);const w=r(!0),h=ce(),x=r("<p>欢迎使用富文本编辑器！点击上方按钮插入 MathQuill 公式。</p>"),C=r(""),F=r(),q=r("default"),_=r(null),b=r(),k=r();let i=null,g=null;const y=r(!1),u=r(""),P=r("common"),R=[{latex:"\\frac{\\dot{V}_A}{\\dot{Q}}",name:"通气血流比"},{latex:"\\dot{V}_A = 4.2\\text{ L/min}",name:"肺泡通气量"},{latex:"\\dot{Q} = 5.0\\text{ L/min}",name:"肺血流量"},{latex:"\\frac{\\dot{V}_A}{\\dot{Q}} \\approx 0.8",name:"正常V̇A/Q̇比值"},{latex:"\\frac{\\dot{V}_A}{\\dot{Q}} = 0",name:"分流状态"},{latex:"\\frac{\\dot{V}_A}{\\dot{Q}} = \\infty",name:"死腔状态"},{latex:"Q_s = 5.0\\text{ L/min}",name:"心输出量"},{latex:"P_{O_2} = 40\\text{ mmHg}",name:"静脉血氧分压"},{latex:"P_{CO_2}",name:"二氧化碳分压"}],S=[{latex:"\\text{BMI} = \\frac{\\text{体重}}{\\text{身高}^2}",name:"BMI指数"},{latex:"\\text{MAP} = \\text{DBP} + \\frac{1}{3}(\\text{SBP} - \\text{DBP})",name:"平均动脉压"},{latex:"\\text{CO} = \\text{HR} \\times \\text{SV}",name:"心输出量"}],H=[{latex:"E = mc^2",name:"质能方程"},{latex:"F = ma",name:"牛顿第二定律"},{latex:"a^2 + b^2 = c^2",name:"勾股定理"}],N=[{latex:"\\frac{a}{b}",name:"分数"},{latex:"\\sqrt{x}",name:"平方根"},{latex:"x^{n}",name:"幂"},{latex:"\\int_{a}^{b} f(x) dx",name:"定积分"},{latex:"\\sum_{i=1}^{n} x_i",name:"求和"}],O={excludeKeys:[]},U={placeholder:"请输入内容...",MENU_CONF:{}},z=()=>new Promise(s=>{if(window.MathQuill){_.value=window.MathQuill.getInterface(2),s(!0);return}const e=document.createElement("script");e.src="https://cdn.bootcdn.net/ajax/libs/jquery/3.6.0/jquery.min.js",e.onload=()=>{const n=document.createElement("link");n.rel="stylesheet",n.href="https://cdn.bootcdn.net/ajax/libs/mathquill/0.10.1/mathquill.min.css",document.head.appendChild(n);const d=document.createElement("script");d.src="https://cdn.bootcdn.net/ajax/libs/mathquill/0.10.1/mathquill.min.js",d.onload=()=>{_.value=window.MathQuill.getInterface(2),p.success("MathQuill 加载成功"),s(!0)},document.body.appendChild(d)},document.body.appendChild(e)}),D=()=>{!b.value||!_.value||(b.value.innerHTML="",i=_.value.MathField(b.value,{spaceBehavesLikeTab:!0,handlers:{edit:()=>{i&&(u.value=i.latex(),M())}}}),i.latex("f(x) = \\frac{1}{\\sqrt{2\\pi}} e^{-\\frac{x^2}{2}}"),u.value=i.latex(),M())},$=()=>{!k.value||!_.value||(k.value.innerHTML="",g=_.value.StaticMath(k.value))},M=()=>{g&&u.value&&g.latex(u.value)},X=()=>{i&&i.latex(u.value),M()},Q=s=>{i&&(i.latex(s),u.value=s,i.focus(),M())},Z=()=>{y.value=!0,j(()=>{i||(D(),$())})},K=()=>{if(!u.value.trim()){p.warning("请输入公式");return}const s=h.value;if(s)try{const e=s,n={type:"formula",value:u.value,children:[{text:""}]};e.insertNode(n),y.value=!1,p.success("公式已插入")}catch(e){console.error("插入公式失败:",e),p.error("插入失败，请重试")}},W=s=>{h.value=s,p.success("编辑器加载完成"),w.value=!1},A=()=>{F.value&&j(()=>{try{F.value.querySelectorAll('span[data-w-e-type="formula"]').forEach(e=>{const n=e.getAttribute("data-value");if(n)try{ue.render(n,e,{throwOnError:!1,displayMode:!e.hasAttribute("data-w-e-is-inline")})}catch(d){console.error("公式渲染错误:",d,"公式:",n),e.textContent=n}})}catch(s){console.error("公式渲染过程出错:",s)}})},G=()=>{C.value=x.value,A(),p.success("内容已更新到预览区域"),console.log("编辑器内容：",x.value)},J=()=>{const s=`
    <h2>这是一个示例标题</h2>
    <p>这是一段示例文本，展示了富文本编辑器的基本功能。</p>
    <p>数学公式示例：<span data-w-e-type="formula" data-w-e-is-void data-w-e-is-inline data-value="E=mc^2"></span></p>
    <p>通气血流比：<span data-w-e-type="formula" data-w-e-is-void data-w-e-is-inline data-value="\\frac{\\dot{V}_A}{\\dot{Q}} \\approx 0.8"></span></p>
  `;x.value=s,C.value=s,A(),p.success("已设置示例内容")},Y=()=>{x.value="",C.value="",p.info("内容已清空")};return me(async()=>{await z(),setTimeout(()=>{w.value&&!h.value&&(w.value=!1)},3e3)}),pe(()=>{const s=h.value;s!=null&&(s.destroy(),i=null,g=null)}),(s,e)=>{const n=m("el-button"),d=m("el-tab-pane"),ee=m("el-tabs"),B=m("el-col"),te=m("el-input"),le=m("el-row"),ae=m("el-dialog"),ne=m("el-card");return v(),f("div",ve,[w.value?(v(),f("div",xe,[...e[5]||(e[5]=[t("div",{class:"loading-content"},[t("div",{class:"spinner"}),t("p",null,"正在初始化 MathQuill 编辑器...")],-1)])])):(v(),f("div",_e,[t("div",he,[e[10]||(e[10]=t("h2",null,"富文本编辑器 (WangEditor + MathQuill)",-1)),e[11]||(e[11]=t("p",{class:"subtitle"},"集成 MathQuill 的交互式数学公式编辑能力",-1)),t("div",ye,[a(n,{type:"primary",onClick:G},{default:o(()=>[...e[6]||(e[6]=[c("获取内容",-1)])]),_:1}),a(n,{onClick:J},{default:o(()=>[...e[7]||(e[7]=[c("设置示例",-1)])]),_:1}),a(n,{onClick:Y},{default:o(()=>[...e[8]||(e[8]=[c("清空",-1)])]),_:1}),a(n,{type:"success",onClick:Z},{default:o(()=>[...e[9]||(e[9]=[t("span",{style:{"font-size":"16px","font-weight":"bold"}},"∑",-1),c(" 插入公式 ",-1)])]),_:1})])]),t("div",we,[a(I(ie),{style:{"border-bottom":"1px solid #ccc"},editor:h.value,defaultConfig:O,mode:q.value},null,8,["editor","mode"]),a(I(re),{style:{height:"300px","overflow-y":"hidden"},modelValue:x.value,"onUpdate:modelValue":e[0]||(e[0]=l=>x.value=l),defaultConfig:U,mode:q.value,onOnCreated:W},null,8,["modelValue","mode"])]),a(ae,{modelValue:y.value,"onUpdate:modelValue":e[4]||(e[4]=l=>y.value=l),title:"插入数学公式 (MathQuill)",width:"1000px","close-on-click-modal":!1},{footer:o(()=>[a(n,{onClick:e[3]||(e[3]=l=>y.value=!1)},{default:o(()=>[...e[16]||(e[16]=[c("取消",-1)])]),_:1}),a(n,{type:"primary",onClick:K},{default:o(()=>[...e[17]||(e[17]=[c("确定插入",-1)])]),_:1})]),default:o(()=>[t("div",Ce,[a(le,{gutter:20},{default:o(()=>[a(B,{span:14},{default:o(()=>[t("div",be,[e[12]||(e[12]=t("h4",null,"公式编辑器：",-1)),t("div",{ref_key:"mathQuillEditorRef",ref:b,class:"mathquill-wrapper"},null,512),e[13]||(e[13]=t("div",{class:"editor-tips"},[t("p",null,[t("strong",null,"提示：")]),t("ul",null,[t("li",null,"点击编辑器开始输入数学公式"),t("li",null,"使用 Tab 键在占位符间切换"),t("li",null,"支持键盘输入 LaTeX 语法")])],-1))]),a(ee,{modelValue:P.value,"onUpdate:modelValue":e[1]||(e[1]=l=>P.value=l),type:"card",class:"template-tabs"},{default:o(()=>[a(d,{label:"常用",name:"common"},{default:o(()=>[t("div",ke,[(v(),f(V,null,E(H,l=>a(n,{key:l.latex,size:"small",onClick:L=>Q(l.latex)},{default:o(()=>[c(T(l.name),1)]),_:2},1032,["onClick"])),64))])]),_:1}),a(d,{label:"呼吸生理学",name:"respiratory"},{default:o(()=>[t("div",ge,[(v(),f(V,null,E(R,l=>a(n,{key:l.latex,size:"small",onClick:L=>Q(l.latex)},{default:o(()=>[c(T(l.name),1)]),_:2},1032,["onClick"])),64))])]),_:1}),a(d,{label:"医学",name:"medical"},{default:o(()=>[t("div",Me,[(v(),f(V,null,E(S,l=>a(n,{key:l.latex,size:"small",onClick:L=>Q(l.latex)},{default:o(()=>[c(T(l.name),1)]),_:2},1032,["onClick"])),64))])]),_:1}),a(d,{label:"数学",name:"math"},{default:o(()=>[t("div",Qe,[(v(),f(V,null,E(N,l=>a(n,{key:l.latex,size:"small",onClick:L=>Q(l.latex)},{default:o(()=>[c(T(l.name),1)]),_:2},1032,["onClick"])),64))])]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(B,{span:10},{default:o(()=>[t("div",Ve,[e[14]||(e[14]=t("h4",null,"LaTeX 代码：",-1)),a(te,{modelValue:u.value,"onUpdate:modelValue":e[2]||(e[2]=l=>u.value=l),type:"textarea",rows:4,onInput:X},null,8,["modelValue"]),e[15]||(e[15]=t("h4",{style:{"margin-top":"16px"}},"渲染预览：",-1)),t("div",Ee,[t("div",{ref_key:"previewRef",ref:k,class:"preview-math"},null,512)])])]),_:1})]),_:1})])]),_:1},8,["modelValue"]),t("div",Te,[e[18]||(e[18]=t("h3",null,"内容预览：",-1)),a(ne,null,{default:o(()=>[t("div",{ref_key:"contentPreviewRef",ref:F,innerHTML:C.value},null,8,Fe)]),_:1})])]))])}}}),je=fe(Le,[["__scopeId","data-v-16347a9e"]]);export{je as default};
